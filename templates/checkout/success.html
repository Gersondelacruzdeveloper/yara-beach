{% extends 'excursions/excursions_base.html' %}
{% load static %}

{% block content %}
<section>
    <div class="container">
        <div class="row">
            <div class="col-md-6 mx-auto mt-5">
                <div class="payment">
                    <div class="payment_header">
                        <div class="check"><i class="fa fa-check" aria-hidden="true"></i></div>
                    </div>
                    <div class="content">
                        <h1>Payment Successfull!</h1>
                        <h4 class="pt-3">Here are your bookings from today</h4>
                        {% for item in user_orders %}
                        <div class="p-2">
                            <small><strong>Excursion Booking Number:</strong> {{item.order_number}}</small>
                        </div>
                        {% endfor %}

                        <strong>Amount paid:</strong>
                        <span>${{excursion_total | floatformat:2}}</span>
                        <div class="pt-2">We have sent you an email with all the booking information</div>
                        <div class="mt-5">
                            <a href="{% url 'home' %}">Go to Home</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
  <!-- Add the script to the head or body of your HTML template -->
<!-- Add the script to the head or body of your HTML template -->
<script>
    function refreshPageOnce() {
      // Check if the 'refreshed' flag is set in sessionStorage
      if (!sessionStorage.getItem('refreshed')) {
        // If not set, wait for 2 seconds (2000 milliseconds)
        setTimeout(function() {
          // Reload the page
          location.reload();
        }, 2000);
  
        // Set the 'refreshed' flag in sessionStorage to indicate that the page has been refreshed
        sessionStorage.setItem('refreshed', true);
  
        console.log("done");
      } else {
        // If the 'refreshed' flag is already set, remove it from sessionStorage
        // This will allow the page to be refreshed again if redirected
        sessionStorage.removeItem('refreshed');
      }
    }
    
    window.onload = function() {
      // Call the refreshPageOnce function when the page loads
      refreshPageOnce();
    };
  </script>
  
  
</section>

{% endblock content %}